<h1 mat-dialog-title>Edit branch {{ pristineBranch.title }} of {{ pristineBranch.gameTitle }}</h1>

<div mat-dialog-content>
    <form class="m-form m-form--fit" [ngClass]="{ dimmed: loading$ | async }" *ngIf="gameBranchInitialized()">
        <fieldset [disabled]="loading$ | async">
            <m-alert [(message)]="errorMessage" kind="danger"></m-alert>

            <div class="form-group m-form__group pl-0 pr-0 mb-1">
                <mat-form-field class="example-full-width">
                    <input
                        type="text"
                        required
                        matInput
                        name="branchTitle"
                        placeholder="Game branch title"
                        [(ngModel)]="branch.title">

                    <mat-hint align="start" class="f-s-12 pt-1">
                        Unique title to identify this game branch
                    </mat-hint>
                </mat-form-field>
            </div>

            <div class="form-group m-form__group pl-0 pr-0 mb-2">
                <mat-form-field class="example-full-width">
                    <input
                        type="text"
                        matInput
                        name="branchDescription"
                        placeholder="Game branch description"
                        [(ngModel)]="branch.description">

                    <mat-hint align="start" class="f-s-12 pt-1">
                        This field is optional
                    </mat-hint>
                </mat-form-field>
            </div>

            <div class="form-group m-form__group pl-0 pr-0 mb-4">
                <mat-form-field class="example-full-width">
                    <input
                        type="text"
                        matInput
                        name="branchPassword"
                        placeholder="Game branch unlock password"
                        [(ngModel)]="branch.password">

                    <mat-hint align="start" class="f-s-12 pt-1">
                        Used to unlock non-public branch at Toadman Launcher
                    </mat-hint>
                </mat-form-field>
            </div>

            <div class="form-group m-form__group pl-0 pr-0 mb-4">
                <mat-form-field class="example-full-width">
                    <mat-select name="gameEngine" placeholder="Game engine" [ngModel]="'' + branch.gameEngine" (ngModelChange)="onGameEngineChange($event)">
                        <mat-option [value]="">Not set</mat-option>

                        <mat-option *ngFor="let engine of gameEngines" value="{{ engine.value }}">
                            <strong>{{ engine.label }}</strong>
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>

            <div class="form-group m-form__group pl-0 pr-0 mb-4">
                <div class="row">
                    <div class="col-md-4 col-sm-12 col-xs-12">
                        <mat-checkbox name="isReportable" color="primary" [(ngModel)]="branch.isReportable">
                            Report Logs
                        </mat-checkbox>
                    </div>

                    <div class="col-md-4 col-sm-12 col-xs-12">
                        <mat-checkbox name="branchIsPublic" color="primary" [(ngModel)]="branch.isPublic">
                            Public
                        </mat-checkbox>
                    </div>

                    <div class="col-md-4 col-sm-12 col-xs-12">
                        <mat-checkbox name="branchIsDeleted" color="warn" [(ngModel)]="branch.isDeleted">
                            Deleted
                        </mat-checkbox>
                    </div>
                </div>
            </div>
        </fieldset>
    </form>
</div>

<div mat-dialog-actions class="justify-content-end">
    <button mat-button [mat-dialog-close]="null" cdkFocusInitial>No, thanks</button>

    <button
        mat-raised-button
        color="primary"
        [disabled]="(loading$ | async) || !gameBranchValid() || !gameBranchChanged()"
        (click)="updateGameBranch()">Update game branch</button>
</div>

